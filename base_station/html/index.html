<!--
/**
 * LEAPS - Low Energy Accurate Positioning System.
 *
 * Main UI HTML file.
 *
 * Copyright (c) 2016-2018, LEAPS. All rights reserved.
 *
 */
-->
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Pond Turtle Monitoring System</title>
    <link rel="stylesheet" href="3rdps/css/jquery-ui.min.css" />
    <link rel="stylesheet" href="css/drtls-manager.css?2018-07-08" />
    <style>
      .logo-container {
        display: flex;
        align-items: center;
        justify-content: center;
        font-family: "Arial", sans-serif;
        font-size: 3em;
        color: #4b2e83;
        text-align: center;
        background: linear-gradient(to right, #f0f0f0, #e0e0e0);
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }
      .logo {
        margin-right: 15px;
        width: 50px;
        height: 50px;
      }
    </style>
  </head>
  <body>
    <div id="scene">
      <div class="logo-container">
        <img
          src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBwgHBgkIBwgKCgkLDRYPDQwMDRsUFRAWIB0iIiAdHx8kKDQsJCYxJx8fLT0tMTU3Ojo6Iys/RD84QzQ5OjcBCgoKDQwNGg8PGjclHyU3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3N//AABEIALoAxwMBIgACEQEDEQH/xAAcAAEAAgMBAQEAAAAAAAAAAAAABwgEBQYDAgH/xABKEAABAwICAwoKBQkJAQAAAAABAAIDBBEFEgYHIRMUFSIxQVGBkaFSVGFxkpOisbLwF1OUwfEjMjM0NUJic9EWNkNV..."
          alt="UW Logo"
          class="logo"
        />
        <span>Turtle Tracking: Team 7 UW</span>
      </div>

      <div id="buttons">
        <div id="hamburger">
          <button id="button-hamburger">
            <span></span><span></span><span></span>
          </button>
          <div id="hamburger-contents">
            <button
              id="button-world-properties"
              title="Change floorplan settings"
            >
              Floorplan
            </button>
            <button
              id="button-online-filter"
              title="Toggle display of offline nodes"
            >
              Hide offline
            </button>
            <button
              id="button-show-labels"
              title="Toggle display of node labels"
            >
              Show labels
            </button>
            <button id="button-ma" title="Smooth tag positions by averaging">
              Position average
            </button>
            <a
              id="button-save-image"
              title="Save snapshot of the current screen"
              >Snapshot</a
            >
            <a id="button-help" href="doc/" title="Go to help page">Help</a>
          </div>
        </div>
        <button id="button-ortho" title="Change between 2D and 3D views">
          2D view
        </button>
        <button id="button-reset-view" title="Go back to initial view">
          Reset view
        </button>
        <button id="button-send-message" title="Send a message using Twilio">
          Send Message
        </button>
      </div>
    </div>
    <div id="ui-right">
      <div id="node-search" title="Start typing name or id to filter nodes">
        <input
          type="text"
          class="js-node-search"
          placeholder="Start typing name or id to filter nodes"
        />
      </div>
      <div id="ui-nodes"></div>
    </div>
    <div id="status-left" class="ui-corner-all">
      <span class="ui-icon"></span><span class="text">Loading</span>
    </div>
    <script src="3rdps/js/jquery-3.1.1.min.js"></script>
    <script src="3rdps/js/jquery-ui.min.js"></script>
    <script src="3rdps/js/three.js"></script>
    <script src="3rdps/js/controls/TrackballControls.js"></script>
    <script src="3rdps/js/paho-mqtt.js"></script>
    <script src="3rdps/js/moment.min.js"></script>
    <script src="js/jqueryui-sorted-accordion.js"></script>
    <script src="js/drtls-manager.js"></script>
    <script>
      var tagPositions = {};

      $(document).ready(function () {
        $("#button-send-message").click(function () {
          alert("clicked");
          const accountSid = "  ";
          const authToken = "  ";
          const fromNumber = "+18449845241";
          const numbers = [
            "+13476152471",
            "+14255247294",
            "+12064840896",
            "+12065046494",
          ];

          let message = "Tag Positions:\n";
          //   for (const [id, position] of Object.entries(tagPositions)) {
          //     message += `Tag ${id}: (${position.x.toFixed(
          //       2
          //     )}, ${position.y.toFixed(2)}, ${position.z.toFixed(2)})\n`;
          //   }
          numbers.forEach(function (toNumber) {
            $.ajax({
              url: `https://api.twilio.com/2010-04-01/Accounts/${accountSid}/Messages.json`,
              type: "POST",
              data: {
                From: fromNumber,
                To: toNumber,
                Body: message,
              },
              beforeSend: function (xhr) {
                xhr.setRequestHeader(
                  "Authorization",
                  "Basic " + btoa(accountSid + ":" + authToken)
                );
              },
              success: function (response) {
                console.log(`Message sent successfully to ${toNumber}!`);
              },
              error: function (error) {
                console.error(`Failed to send message to ${toNumber}.`);
              },
            });
          });
        });
      });

      // $(document).ready(function() {
      //     $('#button-send-message').click(function() {
      //         const accountSid = '  ';
      //         const authToken = '  ';
      //         const fromNumber = '+18449845241';
      //         const message = 'Hello, this is a test message from Twilio!';
      //         const numbers = [  ];

      //         numbers.forEach(function(toNumber) {
      //             $.ajax({
      //                 url: `https://api.twilio.com/2010-04-01/Accounts/${accountSid}/Messages.json`,
      //                 type: 'POST',
      //                 data: {
      //                     From: fromNumber,
      //                     To: toNumber,
      //                     Body: message
      //                 },
      //                 beforeSend: function(xhr) {
      //                     xhr.setRequestHeader('Authorization', 'Basic ' + btoa(accountSid + ':' + authToken));
      //                 },
      //                 success: function(response) {
      //                     console.log(`Message sent successfully to ${toNumber}!`);
      //                 },
      //                 error: function(error) {
      //                     console.error(`Failed to send message to ${toNumber}.`);
      //                 }
      //             });
      //         });
      //     });
      // });
    </script>
  </body>
</html>
